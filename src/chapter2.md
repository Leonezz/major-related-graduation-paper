---
bibliography: [../ref.bib]
fignos-cleveref: True
fignos-caption-name: 图
tablenos-cleveref: True
tablenos-caption-name: 表
---

# 系统总体方案

## 系统功能设计

本课题的目的是设计出一套智能的便于使用的城市社区垃圾桶系统，系统组成可分为智能垃圾桶终端系统、Android上位机系统、服务器后端系统和数据应用系统四个部分。主要实现以下几个功能：

#### 城市社区垃圾桶状态监控。
通过智能垃圾桶终端的传感器实时监测和缓存垃圾桶内部状态信息，并通过Android上位机采集上传到服务器后端系统。服务端实时对来自各垃圾桶的状态数据进行渲染，实现城市社区垃圾桶的可视化监控。

#### 垃圾桶满溢及异常告警。
当有垃圾桶内部装满垃圾时，智能垃圾桶终端系统的桶满传感器会监测到这一状况并通过上位机上传到服务器。服务器后端系统分析到这一数据时便会向管理人员发送信息提醒对满溢垃圾桶进行清理回收。服务器后端系统会实时分析来自智能垃圾桶终端系统的温度传感器和可燃气体传感器的数据，根据桶内温度和可燃气体浓度推断发生火灾的可能性，当超过一定阈值时，系统会向管理人员发送警告，提醒其前往查看处理。

#### 人机交互。
当用户通过智能垃圾桶终端的按键或Android上位机的触屏交互系统请求开启桶盖时，智能垃圾桶终端系统通过控制电动推杆实现垃圾桶盖的控制，方便用户使用。Android上位机系统会将其所管理的垃圾桶内部状态信息在其屏幕上渲染，让用户得知桶内状况。当垃圾桶已满或者内部状态异常时，会提醒用户且锁定桶盖。

#### 用户身份认证。 
用户投递垃圾时，可以使用身份ID进行认证登录，若投递的垃圾属于可回收垃圾，系统会计算用户投递的重量，并给与用户一定的积分奖励。用户的信息和积分数量信息存储在服务器后端系统的数据库中。

## 系统整体架构设计

为完成上节所提出的功能，系统的四个模块（智能垃圾桶终端、Android上位机、服务器后端和数据应用）需要完成的功能如下：

1. 智能垃圾桶终端
通过多种传感器实现垃圾桶状态信息的采集功能，通过嵌入式扫码器实现用户ID信息的录入，通过电动推杆实现桶盖的智能控制功能等。还需设计实现终端系统与上位机之间的交互接口，以实现数据的读出。

2. Android上位机
通过开发Android系统应用程序，实现对终端系统数据的读取和渲染功能，实现人机交互接口和服务端接入。当用户扫码登录时向服务端查询验证用户ID信息，并在用户投递后进行积分计算和上传。同时上位机系统以一定的时间间隔将垃圾桶的状态信息打包同步至服务器。

3. 服务器后端
通过合理的服务端软件设计实现分布式的智能垃圾桶上位机的数据同步和用户登录认证功能。服务端系统需要对大量部署的智能垃圾桶终端及Android上位机系统的数据上传做持久化处理，以及需要设计面向终端系统和数据应用系统请求的接口，实现对终端系统和数据应用系统请求的响应。

4. 数据应用
针对服务端采集到的大量数据和预留的接口，可以开发多种功能的数据应用，如智能管理平台、用户积分系统、数字孪生体、数据分析系统等。如智能管理平台可以实现对城市社区垃圾桶状态的实时监控和管理、异常警报、满溢提醒等。

本系统四个子模块之间的交互关系如下：

1. 智能垃圾桶终端与Android上位机之间的交互
智能垃圾桶终端部署在每个垃圾桶上，实时采集垃圾桶状态信息，等待用户操作，并将采集的信息缓存下来。每个Android上位机管理n个智能垃圾桶终端（n一般取4，可以在1~255之间任意扩展），相当于一组垃圾桶共用一个上位机系统。上位机将每个智能垃圾桶终端的状态数据采集汇总，在人机交互界面上渲染，同时以一定的频率向服务端同步。同时用户可以在上位机的界面上操作控制垃圾桶开盖。

2. Android上位机与服务器后端之间的交互
Android上位机以一定的频率将其采集的来自各垃圾桶的状态数据打包发送到服务端，由服务端系统对数据进行持久化处理。同时，通过服务器后端系统的接口，当用户通过垃圾桶的扫码器扫码时，Android上位机系统会把用户二维码ID发送至服务端进行查询认证，认证成功的用户才可以获得垃圾分类积分奖励。

3. 数据应用于服务器后端之间的交互
基于服务端数据库中存储的大量垃圾桶状态数据，通过服务端系统预留的接口，数据应用可以从服务端请求数据。对于某些系统（如管理系统）的某些操作（如删除操作），数据应用系统也可以改写服务端数据。

系统的整体架构图如{@fig:OverallStructure}所示：

![系统整体架构图](imgs/OverallStructure.png){#fig:OverallStructure width=15.5cm}

## 小结

本章通过对系统需求的深入分析，对系统的功能方案进行了分析和设计。在功能方案的基础上，结合课题要求，分析整理了系统各子模块之间的交互逻辑关系。最后，根据模块交互关系和网络互联关系绘制了系统的整体架构图，形成了系统的整体设计方案，为系统的实现打下了基础。